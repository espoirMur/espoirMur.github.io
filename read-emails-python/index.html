<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#007acc;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}</style><style data-href="/styles.0194413585df59861852.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#000;text-shadow:0 1px #fff}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.navigation-links{text-align:right;text-decoration:none}.navigation-links li{color:#eee;display:inline-block;padding:10px 20px;border-radius:20px;-webkit-transition:all .8s;transition:all .8s;text-decoration:none}.navigation-links li.active{text-decoration:underline}.navigation-links li:hover{color:#eee;cursor:pointer;text-decoration:underline}body{background-color:#22264a;background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEyMCI+PGRlZnM+PHBhdHRlcm4gcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImMiIHdpZHRoPSI2MCIgaGVpZ2h0PSIxMjAiIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCA1IDEwIj48cGF0aCBmaWxsLW9wYWNpdHk9IjAiIHN0cm9rZT0iIzI5MjkyOSIgc3Ryb2tlLXdpZHRoPSIwLjA5IiBkPSJNLTIsMUw3LDEwTS0yLDZMNywxNU0tMiwtNEw3LDUiLz48L3BhdHRlcm4+PHBhdHRlcm4gcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImMyIiB3aWR0aD0iNjAiIGhlaWdodD0iMTIwIiB4PSIxMDAlIiB5PSIwIiB2aWV3Qm94PSIwIDAgNSAxMCI+PHBhdGggZmlsbC1vcGFjaXR5PSIwIiBzdHJva2U9IiMyOTI5MjkiIHN0cm9rZS13aWR0aD0iMC4wOSIgZD0iTTcsMUwtMiwxME03LDZMLTIsMTVNNywtNEwtMiw1Ii8+PC9wYXR0ZXJuPjwvZGVmcz48cmVjdCB3aWR0aD0iNTAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjYykiLz48cmVjdCB4PSI1MCUiIHdpZHRoPSI1MCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNjMikiLz48L3N2Zz4=");margin:0;padding:0;overflow-x:hidden;height:100%;font-family:Lato,Helvetica,arial,sans-serif;font-weight:300;font-size:20px;line-height:1.45;color:#eee;color:hsla(0,0%,100%,.85)}#container{padding-top:50px}#content{max-width:43em;padding:10px;margin:0 auto}.subhead{font-size:1.2em;font-weight:300;line-height:1.5}li,p{font-size:1.7em}a{box-shadow:none;font-weight:700;text-decoration:none;color:#fff}a:hover{text-decoration:underline}p#pleft,p#pright{max-width:20em;float:left}ul{clear:both}html{font-size:62.5%}body{font-size:1em}@media (min-width:600px){html{font-size:80%}}@media (min-width:880px){html{font-size:120%}li,p{font-size:1em}p#pright{margin-left:3em}}.my-details{display:flex;flex-direction:row;flex-wrap:wrap}.my-details img{flex-grow:0;flex-shrink:0;width:150px;height:140px;border-radius:50%;background-repeat:no-repeat;background-position:50%;background-size:cover;margin-left:auto;margin-top:5px;margin-bottom:5px}.my-name{padding-left:5px;font-size:4.8em;font-weight:100;text-transform:uppercase}@media (max-width:768px){.my-details img{margin-left:-245px}.my-name{margin-top:150px;margin-left:20px}}@media (max-width:560px){.my-details img{margin-left:-215px}}@media (max-width:320px){.my-details img{margin-left:-180px}.my-name{font-size:3.5em;margin-top:150px;margin-left:20px}}</style><meta name="generator" content="Gatsby 2.18.12"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/icons/icon-48x48.png?v=a5cff9604d0fdc6a2a4b5cbbc637b89f"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a5cff9604d0fdc6a2a4b5cbbc637b89f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a5cff9604d0fdc6a2a4b5cbbc637b89f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a5cff9604d0fdc6a2a4b5cbbc637b89f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a5cff9604d0fdc6a2a4b5cbbc637b89f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a5cff9604d0fdc6a2a4b5cbbc637b89f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a5cff9604d0fdc6a2a4b5cbbc637b89f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a5cff9604d0fdc6a2a4b5cbbc637b89f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a5cff9604d0fdc6a2a4b5cbbc637b89f"/><title data-react-helmet="true">Reading Emails from a Mailbox with python | My ideas&#x27; home</title><meta data-react-helmet="true" name="description" content="Tutorials on how to read emails in Python"/><meta data-react-helmet="true" property="og:title" content="Reading Emails from a Mailbox with python"/><meta data-react-helmet="true" property="og:description" content="Tutorials on how to read emails in Python"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Espoir Murhabazi"/><meta data-react-helmet="true" name="twitter:title" content="Reading Emails from a Mailbox with python"/><meta data-react-helmet="true" name="twitter:description" content="Tutorials on how to read emails in Python"/><script data-react-helmet="true" type="application/ld+json">{"@context":"https://murhabazi.com","@type":"Personal","url":"https://murhabazi.com","name":"Espoir Murhabazi Website","contactPoint":{"@type":"ContactPoint","telephone":"+250 78 48 3 48 36","contactType":"Personal number"}}</script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-2a66e6bd63d8b59f34dc.js"/><link as="script" rel="preload" href="/app-13a5ec63985c36139973.js"/><link as="script" rel="preload" href="/styles-56e7429501300363e862.js"/><link as="script" rel="preload" href="/commons-e1257f76149fda44e4bb.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-959fbd16f1e490c26892.js"/><link as="fetch" rel="preload" href="/page-data/read-emails-python/page-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:42rem;padding:2.625rem 1.3125rem"><nav class="navigation"><div class="container"><ul class="navigation-links"><li> <a href="/">Home</a> </li><li> <a href="/blog">Blog</a> </li><li><a target="_blank" href="https://drive.google.com/file/d/14yle0nyGH_Kyk7L67nvqwl90FobvY7W0/view?usp=sharing" rel="noopener noreferrer">Resume</a></li></ul></div></nav><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;text-decoration:none;color:inherit" href="/blog">My ideas&#x27; home</a></h3></header><main><main></main> <article><header><h1 style="margin-top:1.75rem;margin-bottom:0">Reading Emails from a Mailbox with python<!-- --> </h1> <p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem">14 February, 2020<!-- --> </p> </header> <section><h3>The Problem</h3>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1f0a7d33aa206088d396fdfffcd8ce0f/31edf/cover-image.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABQAE/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAcTAuqGoCP/EABwQAAICAgMAAAAAAAAAAAAAAAECAAMEEhMhQv/aAAgBAQABBQJHPJRbpDkIJ7J7LGf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAQQf/aAAgBAgEBPwGH/8QAGxAAAgEFAAAAAAAAAAAAAAAAAAECEBESIUH/2gAIAQEABj8CRjK50izVP//EABwQAAICAgMAAAAAAAAAAAAAAAERACExUWGRof/aAAgBAQABPyE25vuWDkisYhJHxGhaWpvg+YAcz//aAAwDAQACAAMAAAAQ6B//xAAXEQEBAQEAAAAAAAAAAAAAAAABABEh/9oACAEDAQE/EE7Y3//EABcRAAMBAAAAAAAAAAAAAAAAAAABEWH/2gAIAQIBAT8QbUQun//EABsQAQADAQADAAAAAAAAAAAAAAEAESExUWGB/9oACAEBAAE/EDQS+bemCcy9iq+Yh1kupJYYnYEWrZWuyv3Z/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="email"
        title="email"
        src="/static/1f0a7d33aa206088d396fdfffcd8ce0f/88218/cover-image.jpg"
        srcset="/static/1f0a7d33aa206088d396fdfffcd8ce0f/7237a/cover-image.jpg 148w,
/static/1f0a7d33aa206088d396fdfffcd8ce0f/0cfdf/cover-image.jpg 295w,
/static/1f0a7d33aa206088d396fdfffcd8ce0f/88218/cover-image.jpg 590w,
/static/1f0a7d33aa206088d396fdfffcd8ce0f/77d57/cover-image.jpg 885w,
/static/1f0a7d33aa206088d396fdfffcd8ce0f/5a917/cover-image.jpg 1180w,
/static/1f0a7d33aa206088d396fdfffcd8ce0f/31edf/cover-image.jpg 6240w"
        sizes="(max-width: 590px) 100vw, 590px"
        loading="lazy"
      />
  </a>
    </span></p>
<p>Recently I received a request from my client.
He requested that I  write a script that connects to a specific mailbox, check if there are new emails, read them, and download the attachments and perform some data analysis on those attachments.
I was super excited about this task, and I asked myself; is it possible to read emails using Python? </p>
<h3>The solution</h3>
<p>I started googling, and I was lucky to find that it is possible to read emails using Python.</p>
<p>In this blog post, I will explain how I managed to read emails from an IMAP mail server, and how I downloaded the attachments and saved them into a  specific folder.</p>
<p>If you are familiar with Python, this tutorial is for you. To complete this tutorial, you need to have python 3.6 installed in your laptop and virtual environment installed.</p>
<h4>First things first; create the project and initialize your virtual environment</h4>
<p>Let us create a project we will be using :
Navigate to your command line and type the following lines of code :
<code class="language-text">mkdir read_emails_project &amp; cd read_emails_project</code></p>
<p>Once in the project, let’s initialize git :</p>
<p><code class="language-text">git init</code></p>
<p>Once we initialized git, let’s create a virtual environment:
<code class="language-text">virtualenv -p python .venv</code></p>
<p>You can activate the virtual environment with the following line of code :</p>
<p><code class="language-text">source .venv/bin/activate</code></p>
<p>It’s not a must to use a virtual environment. You can use your preferred environment manager; I just prefer to use virtual environments.</p>
<p>Once you complete the setup, we can start with the exciting part of the project.</p>
<h4>Never Write secrete credentials into code, use environment variables</h4>
<p>Since we are reading emails from an inbox, we will need email credentials. From where are we reading those credentials?
One thing for sure; we are not putting them into the code, this is a BAD PRACTISE !!!
The developer community can punish you for writing credentials or secret code directly into a codebase.
We will be using <code class="language-text">.env</code> file, whose content will be known to us only, and we will never share it with anyone online, even putting it in a private git repository.</p>
<p>Let us create the <code class="language-text">.env</code> file </p>
<p><code class="language-text">touch .env</code></p>
<p>And create a gitignore file to tell git which files to ignore.</p>
<p><code class="language-text">touch .gitignore</code></p>
<p>open the .gitignore and add the following lines  it to ignore the <code class="language-text">.env</code> file :</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">    .venv
    env</code></pre></div>
<p>In those lines, we are instructing git to ignore our <code class="language-text">.env</code> files and our virtual environments.</p>
<p>Now we can populate the <code class="language-text">.env</code> file with our credentials :</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">USER_EMAIL=&#39;your@email.com&#39;
USER_PASSWORD=&#39;your secret password.&#39;</code></pre></div>
<p>We have recorded  our email credentials in the <code class="language-text">.env</code> file; let us now write a method that reads them from there.
For this task, we will be using a Python package called <a href="https://github.com/theskumar/python-dotenv">python-dotenv</a></p>
<p>let’s install it with :
<code class="language-text">pip install -U python-dotenv</code></p>
<p>let us write a function that reads and returns those environment variables : </p>
<p>You can create a file with a name <code class="language-text">utils.py</code> and add the following lines of code : </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> os
<span class="token keyword">from</span> dotenv <span class="token keyword">import</span> load_dotenv

<span class="token keyword">def</span> <span class="token function">read_credentails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Return user’s credentials from the environment variables file and 
    raise a an exception if the credentials are not present 
    
    Raises:
        NotImplementedError: [description]
    """</span>
    load_dotenv<span class="token punctuation">(</span><span class="token punctuation">)</span>

    USER_EMAIL <span class="token operator">=</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"USER_EMAIL"</span><span class="token punctuation">)</span>
    USER_PASSWORD <span class="token operator">=</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"USER_PASSWORD"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> USER_EMAIL <span class="token keyword">and</span> USER_PASSWORD<span class="token punctuation">:</span>
        <span class="token keyword">return</span> USER_EMAIL<span class="token punctuation">,</span> USER_PASSWORD
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span>'Please add a <span class="token punctuation">.</span>env <span class="token builtin">file</span> <span class="token keyword">and</span> write the credentials it it <span class="token punctuation">,</span>
                         refer to the sample'<span class="token punctuation">)</span></code></pre></div>
<p>From that function, you can notice that we are using the <code class="language-text">load_env</code> function, it loads the environment variables from our <code class="language-text">.env</code> file and exposes them to system environment variables so we can be able to read them from there.
After reading the environment variables, the function returns them as a tuple.
In the next section, we are going to perform the most exciting part of this tutorial; it involves reading emails and downloading attachments.</p>
<h4>Reading emails:</h4>
<p>I was happy to find that Python has a built-in feature that enables us to connect to a mailbox. It is in the <code class="language-text">imaplib</code> module.
It also has a module to parse emails.</p>
<p>Let’s create a file <code class="language-text">reading_emails_scripts.py</code> inside it; we are about to perform all the magic we need.</p>
<p>Let us import the modules we need :</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> email <span class="token keyword">import</span> message_from_bytes
<span class="token keyword">from</span> imaplib <span class="token keyword">import</span> IMAP4_SSL
<span class="token keyword">from</span> <span class="token punctuation">.</span>utils <span class="token keyword">import</span> read_credentails</code></pre></div>
<p>We are importing the : </p>
<ul>
<li>message<em>from</em>bytes function from the email module. It will help us to read the emails which come as bytes and convert them to text.</li>
<li>IMAP4_SSL: class which is the main class that will help us to perform all the operations.
Note that we are using IMAP4 protocol to read emails, IMAP4 is a mail protocol used to access a mailbox on a remote server from a local email client. IMAP can be more complex but provides more conveniences for syncing across multiple devices.
You can read more about emails protocol <a href="https://www.navigator.ca/support/imap-pop3-smtp/">here</a> </li>
<li>our read_credentials function, which we introduced in the previous section.</li>
</ul>
<p>I have created a function that perform the operation and return a generator with all mails found in the mailbox , here it is :</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_unseen_emails</span><span class="token punctuation">(</span>email_address<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Filter the email and return unseen emails
    Args:
        email_address (string): recipient email
        password (password): recipient password
    """</span>
    <span class="token keyword">with</span> IMAP4_SSL<span class="token punctuation">(</span><span class="token string">"your_imap_server"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> mail_connection<span class="token punctuation">:</span>
        mail_connection<span class="token punctuation">.</span>login<span class="token punctuation">(</span>email_address<span class="token punctuation">,</span> password<span class="token punctuation">)</span>
        mail_connection<span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        mail_connection<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'INBOX'</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span>retcode<span class="token punctuation">,</span> messages<span class="token punctuation">)</span> <span class="token operator">=</span> mail_connection<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span>
            <span class="token string">'(OR (UNSEEN) (FROM your.email@gmail.com))'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> retcode <span class="token operator">==</span> <span class="token string">'OK'</span> <span class="token keyword">and</span> messages<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> index<span class="token punctuation">,</span> num <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>messages<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                typ<span class="token punctuation">,</span> data <span class="token operator">=</span> mail_connection<span class="token punctuation">.</span>fetch<span class="token punctuation">(</span>num<span class="token punctuation">,</span> <span class="token string">'(RFC822)'</span><span class="token punctuation">)</span>
                message <span class="token operator">=</span> message_from_bytes<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                typ<span class="token punctuation">,</span> data <span class="token operator">=</span> mail_connection<span class="token punctuation">.</span>store<span class="token punctuation">(</span>num<span class="token punctuation">,</span> <span class="token string">'+FLAGS'</span><span class="token punctuation">,</span> <span class="token string">'\\Seen'</span><span class="token punctuation">)</span>
                <span class="token keyword">yield</span> message</code></pre></div>
<p>You can see that we are instantiating a secure mail<em>connection from the IMAP4SSL class and using it with the python context manager.
We will be using the mail</em>connection object to perform all the operations we want to our mailbox.</p>
<p>After instantiating, we log in to the mailbox with our credentials, then we list all the mailbox categories we have, e.g.: In Google, we have INBOX, SPAM, UPDATES, FORUMS, SPAMS, etc
We select only the inbox folder, and from the inbox, we filter only unseen messages or emails coming from your email address.
Note that you can search for anything in your inbox and even complicated queries.</p>
<p>The search returns retcodes with messages and their IDS
Note that : </p>
<blockquote>
<p>The server assigned messages id to emails, and are implementation-dependent. The IMAP4 >protocol makes a distinction between sequential ids for messages at a given point in time >during a transaction and UID identifiers for messages, but not all servers seem to bother.</p>
</blockquote>
<p>Once we have messages ids, we can fetch ids and the format of the headers we want.
We are using RFC822 to fetch the entire message as an RFC 2822 formatted message.
RFC 2822 is a protocol for standard messages sent between computers; you can read more about it <a href="https://tools.ietf.org/html/rfc2822.html">here</a></p>
<p>In the next line, we are using the message<em>from</em>bytes function from the email module to convert the bytes we received as a message.</p>
<p>Then we mark the message as seen by using the store method
and we yield the results.
This means the function will return an iterator which is an object we can iterate over. Find more about iterators and generators in python <a href="%5Bhttps://stackoverflow.com/questions/9884132/what-exactly-are-iterator-iterable-and-iteration%5D(https://stackoverflow.com/questions/9884132/what-exactly-are-iterator-iterable-and-iteration)">here</a> and <a href="%5Bhttps://www.programiz.com/python-programming/generator%5D(https://www.programiz.com/python-programming/generator)">here</a>.</p>
<p>Once we have retrieved the emails, let us create the function that gets attachments from that email.</p>
<h3>Getting attachment from the email:</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_mail_attachments</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> condition_check<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Get attachments files from mail
    Args:
        message (email ): email object to retrieve attachment from
        condition_check ([function]): the function to use when filtering the
        email should return specific condition we are filtering
    Returns:
        [filename, file]: the file name, input stream from the files
    """</span>
    <span class="token keyword">for</span> part <span class="token keyword">in</span> message<span class="token punctuation">.</span>walk<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> part<span class="token punctuation">.</span>get_content_maintype<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'multipart'</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> part<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Content-Disposition'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        file_name <span class="token operator">=</span> part<span class="token punctuation">.</span>get_filename<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> condition_check<span class="token punctuation">(</span>file_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">yield</span> part<span class="token punctuation">.</span>get_filename<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> part<span class="token punctuation">.</span>get_payload<span class="token punctuation">(</span>decode<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></code></pre></div>
<p>This function takes the email object yielded by the  last function and a filter function which tells which extension we can filter from the email, iterate over all his part using the walk() method. For each part we check if the main type is not multipart , and content disposition is  None</p>
<p>If none of those conditions is satisfied, we get the file name and return the byte stream from the email.</p>
<h4>Putting everything together:</h4>
<p>We now have all the building blocks of the application. Let’s put them in the main function:</p>
<p>create a file called <code class="language-text">run.py</code> and add the following code inside: </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> utils <span class="token keyword">import</span> read_credentails
<span class="token keyword">from</span> reading_emails_scripts <span class="token keyword">import</span> get_mail_attachments<span class="token punctuation">,</span> get_unseen_emails
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
 email_address<span class="token punctuation">,</span> password <span class="token operator">=</span> read_credentails<span class="token punctuation">(</span><span class="token punctuation">)</span>
    messages <span class="token operator">=</span> get_unseen_emails<span class="token punctuation">(</span>email_address<span class="token punctuation">,</span> password<span class="token punctuation">)</span>
    <span class="token keyword">if</span> messages<span class="token punctuation">:</span>
        <span class="token keyword">for</span> message <span class="token keyword">in</span> messages<span class="token punctuation">:</span>
            attachments <span class="token operator">=</span> get_mail_attachments<span class="token punctuation">(</span>message<span class="token punctuation">,</span>
                                              <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'.xml'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> attachment <span class="token keyword">in</span> attachments<span class="token punctuation">:</span>
                <span class="token keyword">if</span> attachment<span class="token punctuation">:</span>
                    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./data/xml_files/{}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>attachment<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
                        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>attachment<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div>
<p>We can see that; we call read<em>credentials which returns the credentials from the .env file,
We call the get</em>unseen<em>emails method which returns our messages , we check if the message has attachments with get</em>mail_attachment function and if there is an attachment we save it to a folder of our choice.</p>
<h3>Conclusion</h3>
<p>In this tutorial, we went through the whole process of reading emails with Python, we saw how to download attachments from emails, and we put everything together to have a fully working script.</p>
<p>It’s also a good practice to write unit tests to test the code you are writing because I believe that something that is not tested is broken.</p>
<p>In the next part, we will see how you can write unit tests for this piece of code. So stay tuned for more.</p>
<p>You can check the code for this tutorial from this <a href="%5Bhttps://github.com/espoirMur/read_emails_with_python%5D(https://github.com/espoirMur/read_emails_with_python)">Github repository</a>.</p>
<p>Cheers!</p>
<h4>References :</h4>
<ul>
<li>Python Module of the week <a href="https://pymotw.com/2/imaplib/">imaplib</a></li>
<li><a href="https://medium.com/@sdoshi579/to-read-emails-and-download-attachments-in-python-6d7d6b60269">Read Emails and Download attachments </a></li>
<li><a href="https://stackoverflow.com/a/29629741/4683950">Read only new emails in Python on StackOverflow</a></li>
</ul></section> <hr style="margin-bottom:1.75rem"/> <footer><div style="display:flex;margin-bottom:4.375rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.875rem;margin-bottom:0;min-width:50px;border-radius:100%"><img src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIEBQMG/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABxpXpmM6j0MArA//EABsQAAICAwEAAAAAAAAAAAAAAAECAxIABBET/9oACAEBAAEFAols8i8GRa3HaC+SJRkPXJPjIBb/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAACAQUAAAAAAAAAAAAAAAAAARECECEiMf/aAAgBAQAGPwJK6lm2CCobOH//xAAaEAEAAgMBAAAAAAAAAAAAAAABACERMUFR/9oACAEBAAE/IQc1DJPYyzWS64x1baP3+M1I0MvS8MQxDip//9oADAMBAAIAAwAAABBAwAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAdEAEBAQACAgMAAAAAAAAAAAABEQAhMVFhcYHB/9oACAEBAAE/EOQ9VSywuCGWe/W7ZGKMrieB+8kohxEQrn6ZggdmVaF43mp+GAiu8/M3VZJbZv/Z" alt="Espoir Murhabazi" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/static/3f2f54167cc9ea9c538f94f7a91e5e01/30d3a/profile-pic.jpg 1x,
/static/3f2f54167cc9ea9c538f94f7a91e5e01/66c95/profile-pic.jpg 1.5x,
/static/3f2f54167cc9ea9c538f94f7a91e5e01/aacbd/profile-pic.jpg 2x" /><img loading="lazy" width="50" height="50" srcset="/static/3f2f54167cc9ea9c538f94f7a91e5e01/30d3a/profile-pic.jpg 1x,
/static/3f2f54167cc9ea9c538f94f7a91e5e01/66c95/profile-pic.jpg 1.5x,
/static/3f2f54167cc9ea9c538f94f7a91e5e01/aacbd/profile-pic.jpg 2x" src="/static/3f2f54167cc9ea9c538f94f7a91e5e01/30d3a/profile-pic.jpg" alt="Espoir Murhabazi" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div> <p>Written by <strong> <!-- -->Espoir Murhabazi<!-- --> </strong> , a Engineer from DRC<!-- --> <span class="flag-icon flag-icon-cd"></span> who is currently living and working in Rwanda <span class="flag-icon flag-icon-cd"> . </span></p></div></footer> </article><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li> <a rel="prev" href="/customs-git-config/"> <!-- -->←<!-- -->My Customs Git Configurations<!-- --> </a> </li> <li> <a rel="next" href="/remote-work-africa-french/"> <!-- -->Quelques meilleurs conseils pour un travail efficace à distance, une réalité africaine<!-- -->→<!-- --> </a> </li> </ul> </nav> </main><footer>© <!-- -->2020<!-- -->, Build by Espy Mur</footer></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/read-emails-python/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-13a5ec63985c36139973.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-58be84fb0a4e567a4acb.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-959fbd16f1e490c26892.js"],"component---src-components-blog-index-js":["/component---src-components-blog-index-js-15d4345b9e6d8918672b.js"],"component---src-pages-404-js":["/component---src-pages-404-js-96cc17a2d9b87624a478.js"],"component---src-pages-index-js":["/component---src-pages-index-js-6fea2cba67aebbf3d465.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-959fbd16f1e490c26892.js" async=""></script><script src="/commons-e1257f76149fda44e4bb.js" async=""></script><script src="/styles-56e7429501300363e862.js" async=""></script><script src="/app-13a5ec63985c36139973.js" async=""></script><script src="/webpack-runtime-2a66e6bd63d8b59f34dc.js" async=""></script></body></html>